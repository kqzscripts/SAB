local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "KqzExploitz | SKIBIDI Steal a Brainrot",
   LoadingTitle = "KqzExploitz",
   LoadingSubtitle = "Universal Support (PC/Mobile/Console)",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "KqzExploitz",
      FileName = "BrainrotScript"
   },
   Discord = {
      Enabled = false,
      Invite = "",
      RememberJoins = true
   },
   KeySystem = false
})

local Main = Window:CreateTab("Main", 4483362458)
local Settings = Window:CreateTab("Settings", 4483362458)

local player = game.Players.LocalPlayer
local desyncPos = nil
local desyncPart = nil
local isMovingForever = false

-- Function to handle continuous movement/bypass
local function ensureMovement()
    if isMovingForever then
        local char = player.Character
        if char and char:FindFirstChild("Humanoid") then
            char.Humanoid.PlatformStand = false
            for _, part in pairs(char:GetChildren()) do
                if part:IsA("BasePart") then
                    part.Velocity = Vector3.new(0, 0, 0)
                    part.RotVelocity = Vector3.new(0, 0, 0)
                end
            end
        end
    end
end

game:GetService("RunService").Heartbeat:Connect(ensureMovement)

Main:CreateButton({
   Name = "Respawn Desync",
   Callback = function()
       local character = player.Character
       if character and character:FindFirstChild("HumanoidRootPart") then
           desyncPos = character.HumanoidRootPart.CFrame
           
           if desyncPart then desyncPart:Destroy() end
           desyncPart = Instance.new("Part")
           desyncPart.Name = "ServerPosMarker"
           desyncPart.Size = Vector3.new(2, 2, 2)
           desyncPart.CFrame = desyncPos
           desyncPart.Anchored = true
           desyncPart.CanCollide = false
           desyncPart.Transparency = 0.5
           desyncPart.Color = Color3.fromRGB(255, 255, 255)
           desyncPart.Parent = game.Workspace
           
           player:LoadCharacter()
           
           task.spawn(function()
               local newChar = player.CharacterAdded:Wait()
               local hrp = newChar:WaitForChild("HumanoidRootPart")
               -- Forced permanent server position lock logic
               -- Even with items like Quantum Clone, we attempt to override the network state
               local bg = Instance.new("BodyGyro", hrp)
               bg.P = 9e4
               bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
               bg.CFrame = desyncPos
           end)
       end
   end,
})

Main:CreateButton({
   Name = "Instant TeleportðŸ’¨",
   Callback = function()
       local character = player.Character
       if character and character:FindFirstChild("HumanoidRootPart") then
           local hrp = character.HumanoidRootPart
           local basePart = game.Workspace:FindFirstChild(player.Name .. "Base") or game.Workspace:FindFirstChild("Base")
           
           isMovingForever = true
           
           -- ANTI-CHEAT BYPASS: Use Flying Carpet as an Anchor
           -- We force the state to "Sitting" or "PlatformStanding" relative to an anchored carpet
           local carpet = character:FindFirstChild("FlyingCarpet") or character:FindFirstChild("Carpet")
           if carpet and carpet:FindFirstChild("Handle") then
               carpet.Handle.Anchored = true -- Force anchor to bypass velocity checks
           end
           
           -- Phase through barriers/locked bases
           hrp.CFrame = (basePart and basePart.CFrame + Vector3.new(0, 3, 0)) or CFrame.new(0, 100, 0)
           
           -- Reset prevention: Force physics state to prevent "Pull Back"
           task.spawn(function()
               for i = 1, 10 do
                   hrp.Velocity = Vector3.new(0, 0, 0)
                   hrp.CFrame = (basePart and basePart.CFrame + Vector3.new(0, 3, 0)) or CFrame.new(0, 100, 0)
                   task.wait(0.1)
               end
               if carpet and carpet:FindFirstChild("Handle") then
                   carpet.Handle.Anchored = false
               end
           end)

           Rayfield:Notify({
               Title = "Bypass Active",
               Content = "Teleported past barriers. Movement unlocked.",
               Duration = 3,
           })
       end
   end,
})

-- ESP Logic (Enhanced for new joins)
local function applyESP(object, name, color)
    if not object:FindFirstChild("ESP_Box") then
        local box = Instance.new("BoxHandleAdornment")
        box.Name = "ESP_Box"
        box.Size = (object:IsA("Model") and object:GetExtentsSize()) or (object:IsA("BasePart") and object.Size) or Vector3.new(2,4,2)
        box.Adornee = object
        box.AlwaysOnTop = true
        box.ZIndex = 5
        box.Transparency = 0.5
        box.Color3 = color
        box.Parent = object
    end
end

Settings:CreateToggle({
   Name = "Player ESP",
   CurrentValue = false,
   Flag = "PlayerESP",
   Callback = function(Value)
       _G.PlayerESP = Value
       task.spawn(function()
           while _G.PlayerESP do
               for _, p in pairs(game.Players:GetPlayers()) do
                   if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                       applyESP(p.Character.HumanoidRootPart, p.Name, Color3.fromRGB(255, 255, 255))
                   end
               end
               task.wait(2)
           end
       end)
   end,
})

Settings:CreateToggle({
   Name = "Best ESP",
   CurrentValue = false,
   Flag = "BestESP",
   Callback = function(Value)
       _G.BestESP = Value
       task.spawn(function()
           while _G.BestESP do
               for _, v in pairs(game.Workspace:GetDescendants()) do
                   if v:IsA("BasePart") and (v.Name:lower():find("brain") or v.Name:lower():find("part")) then
                       applyESP(v, "Part", Color3.fromRGB(200, 200, 200))
                   end
               end
               task.wait(5)
           end
       end)
   end,
})

Rayfield:Notify({
   Title = "KqzExploitz Loaded",
   Content = "Bypass Systems Initialized (PC/Mobile/Console)",
   Duration = 5,
})
