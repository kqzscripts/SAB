-- Chilli Hub (Auto Steal, Aimbot, Fly)
loadstring(game:HttpGet("https://raw.githubusercontent.com/tienkhanh1/spicy/main/Chilli.lua"))()

-- Alternative Hubs (Uncomment to use)
-- Overflow Hub (Jump Boost, Auto Buy, Anti Ragdoll)
-- loadstring(game:HttpGet("https://raw.githubusercontent.com/OverflowBGSI/Overflow/refs/heads/main/loader.txt"))()

-- RIFT Hub (Fast Steal, Auto Fish, Anti Hit)
-- loadstring(game:HttpGet('https://raw.githubusercontent.com/m00ndiety/Steal-a-brainrot/refs/heads/main/Steal-a-Brainrot'))()

-- KqzExploitz UI
local player = game.Players.LocalPlayer
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Cleanup existing UI
local existing = CoreGui:FindFirstChild("KqzExploitzUI")
if existing then existing:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "KqzExploitzUI"
ScreenGui.Parent = CoreGui
ScreenGui.ResetOnSpawn = false

-- State Variables
local savedPos = nil
local desyncPos = nil
local desyncPart = nil
local playerESP = false
local espObjects = {}
local isMinimized = false

-- App-style Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 450, 0, 320)
MainFrame.Position = UDim2.new(0.5, -225, 0.5, -160)
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.fromRGB(45, 45, 45)
UIStroke.Thickness = 1.5
UIStroke.Parent = MainFrame

-- Header
local Header = Instance.new("Frame")
Header.Name = "Header"
Header.Size = UDim2.new(1, 0, 0, 45)
Header.BackgroundTransparency = 1
Header.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -100, 1, 0)
Title.Position = UDim2.new(0, 15, 0, 0)
Title.Text = "KqzExploitz"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.Font = Enum.Font.GothamBold
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.BackgroundTransparency = 1
Title.Parent = Header

-- Control Buttons
local Controls = Instance.new("Frame")
Controls.Size = UDim2.new(0, 80, 1, 0)
Controls.Position = UDim2.new(1, -85, 0, 0)
Controls.BackgroundTransparency = 1
Controls.Parent = Header

local function createControl(text, pos, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 28, 0, 28)
    btn.Position = pos
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(200, 200, 200)
    btn.Font = Enum.Font.GothamBold
    btn.TextSize = 14
    btn.Parent = Controls
    
    local c = Instance.new("UICorner")
    c.CornerRadius = UDim.new(0, 6)
    c.Parent = btn
    
    btn.MouseButton1Click:Connect(callback)
end

createControl("-", UDim2.new(0, 0, 0.5, -14), function()
    isMinimized = not isMinimized
    local targetHeight = isMinimized and 45 or 320
    TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quart), {Size = UDim2.new(0, 450, 0, targetHeight)}):Play()
    MainFrame.TabContainer.Visible = not isMinimized
    MainFrame.PageContainer.Visible = not isMinimized
end)

createControl("X", UDim2.new(0, 35, 0.5, -14), function()
    ScreenGui:Destroy()
end)

-- Sidebar Tabs
local TabContainer = Instance.new("Frame")
TabContainer.Name = "TabContainer"
TabContainer.Size = UDim2.new(0, 100, 1, -55)
TabContainer.Position = UDim2.new(0, 10, 0, 45)
TabContainer.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
TabContainer.BorderSizePixel = 0
TabContainer.Parent = MainFrame

local TabCorner = Instance.new("UICorner")
TabCorner.CornerRadius = UDim.new(0, 10)
TabCorner.Parent = TabContainer

local TabList = Instance.new("UIListLayout")
TabList.Padding = UDim.new(0, 5)
TabList.HorizontalAlignment = Enum.HorizontalAlignment.Center
TabList.Parent = TabContainer

local PageContainer = Instance.new("Frame")
PageContainer.Name = "PageContainer"
PageContainer.Size = UDim2.new(1, -125, 1, -55)
PageContainer.Position = UDim2.new(0, 115, 0, 45)
PageContainer.BackgroundTransparency = 1
PageContainer.Parent = MainFrame

local pages = {}
local function createPage(name)
    local page = Instance.new("ScrollingFrame")
    page.Name = name
    page.Size = UDim2.new(1, 0, 1, 0)
    page.BackgroundTransparency = 1
    page.CanvasSize = UDim2.new(0, 0, 0, 0)
    page.ScrollBarThickness = 2
    page.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 60)
    page.Visible = false
    page.Parent = PageContainer
    
    local layout = Instance.new("UIListLayout")
    layout.Padding = UDim.new(0, 10)
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Center
    layout.Parent = page
    
    local padding = Instance.new("UIPadding")
    padding.PaddingTop = UDim.new(0, 5)
    padding.Parent = page
    
    pages[name] = page
    return page
end

local function showPage(name)
    for n, p in pairs(pages) do p.Visible = (n == name) end
end

local function createTab(name)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0.9, 0, 0, 32)
    btn.BackgroundTransparency = 1
    btn.Text = name
    btn.TextColor3 = Color3.fromRGB(160, 160, 160)
    btn.Font = Enum.Font.GothamSemibold
    btn.TextSize = 13
    btn.Parent = TabContainer
    
    btn.MouseButton1Click:Connect(function()
        showPage(name)
        for _, t in pairs(TabContainer:GetChildren()) do
            if t:IsA("TextButton") then t.TextColor3 = Color3.fromRGB(160, 160, 160) end
        end
        btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    end)
    return btn
end

local mainTab = createTab("Main")
createTab("Settings")
mainTab.TextColor3 = Color3.fromRGB(255, 255, 255)

local MainPage = createPage("Main")
local SettingsPage = createPage("Settings")
showPage("Main")

-- App-style Button Creator
local function createButton(parent, text, callback)
    local btnFrame = Instance.new("Frame")
    btnFrame.Size = UDim2.new(0.95, 0, 0, 40)
    btnFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    btnFrame.Parent = parent

    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 8)
    corner.Parent = btnFrame

    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(40, 40, 40)
    stroke.Thickness = 1
    stroke.Parent = btnFrame

    local button = Instance.new("TextButton")
    button.Size = UDim2.new(1, 0, 1, 0)
    button.BackgroundTransparency = 1
    button.Text = text
    button.TextColor3 = Color3.fromRGB(200, 200, 200)
    button.Font = Enum.Font.GothamSemibold
    button.TextSize = 13
    button.Parent = btnFrame

    button.MouseEnter:Connect(function()
        TweenService:Create(btnFrame, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(35, 35, 35)}):Play()
    end)
    button.MouseLeave:Connect(function()
        TweenService:Create(btnFrame, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(25, 25, 25)}):Play()
    end)

    button.MouseButton1Click:Connect(callback)
end

-- Anti-Cheat Bypass Teleport Logic
local function safeTeleport(targetCFrame)
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    local hrp = char.HumanoidRootPart
    
    -- Anti-cheat bypass strategy:
    -- 1. Use task.spawn to avoid hanging the UI
    -- 2. Briefly anchor to stabilize physics
    -- 3. Move in small increments or use velocity spoofing if needed
    -- 4. Set CFrame directly and wait for physics engine to catch up
    
    task.spawn(function()
        local oldVelocity = hrp.Velocity
        hrp.Velocity = Vector3.new(0, 0, 0)
        
        -- Bypass: Briefly set state to PlatformStanding to prevent ragdoll/rubberband
        local hum = char:FindFirstChild("Humanoid")
        if hum then hum.PlatformStand = true end
        
        -- Multi-step TP to bypass distance checks
        local startPos = hrp.Position
        local dist = (targetCFrame.Position - startPos).Magnitude
        
        if dist > 50 then
            -- For long distances, move through the "void" or high sky briefly
            hrp.CFrame = targetCFrame + Vector3.new(0, 500, 0)
            task.wait(0.1)
        end
        
        hrp.CFrame = targetCFrame
        task.wait(0.1)
        
        if hum then hum.PlatformStand = false end
        hrp.Velocity = oldVelocity
    end)
end

-- Features Implementation
createButton(MainPage, "Save Current Positionüìç", function()
    local char = player.Character
    if char and char:FindFirstChild("HumanoidRootPart") then
        savedPos = char.HumanoidRootPart.CFrame
    end
end)

createButton(MainPage, "TP to Saved Positionüí®", function()
    if savedPos then
        safeTeleport(savedPos)
    end
end)

createButton(MainPage, "Instant Base TPüè†", function()
    local base = game.Workspace:FindFirstChild(player.Name.."Base") or game.Workspace:FindFirstChild("Base")
    if base then
        safeTeleport(base.CFrame + Vector3.new(0, 5, 0))
    end
end)

createButton(MainPage, "Respawn Desync (Fix)", function()
    local char = player.Character
    if char and char:FindFirstChild("Humanoid") then
        char.Humanoid.Health = 0
        local newChar = player.CharacterAdded:Wait()
        local hrp = newChar:WaitForChild("HumanoidRootPart")
        
        if desyncPart then desyncPart:Destroy() end
        desyncPart = Instance.new("Part", workspace)
        desyncPart.Size = Vector3.new(2, 6, 2)
        desyncPart.CFrame = hrp.CFrame
        desyncPart.Anchored = true
        desyncPart.CanCollide = false
        desyncPart.Transparency = 0.5
        desyncPart.Color = Color3.fromRGB(0, 255, 255)
        desyncPart.Material = Enum.Material.Neon
        
        local bg = Instance.new("BillboardGui", desyncPart)
        bg.Size = UDim2.new(0, 150, 0, 30)
        bg.AlwaysOnTop = true
        local tl = Instance.new("TextLabel", bg)
        tl.Size = UDim2.new(1, 0, 1, 0)
        tl.BackgroundTransparency = 1
        tl.Text = "Server Ghost"
        tl.TextColor3 = Color3.new(1, 1, 1)
        tl.Font = Enum.Font.GothamBold
    end
end)

createButton(SettingsPage, "Toggle Player ESP", function()
    playerESP = not playerESP
    for _, obj in pairs(espObjects) do if obj then obj:Destroy() end end
    espObjects = {}
    if playerESP then
        task.spawn(function()
            while playerESP do
                for _, p in pairs(game.Players:GetPlayers()) do
                    if p ~= player and p.Character and not p.Character:FindFirstChild("ESPHighlight") then
                        local highlight = Instance.new("Highlight", p.Character)
                        highlight.Name = "ESPHighlight"
                        highlight.FillColor = Color3.new(1, 0, 0)
                        highlight.OutlineColor = Color3.new(1, 1, 1)
                        table.insert(espObjects, highlight)
                    end
                end
                task.wait(1)
            end
        end)
    end
end)

-- Dragging Logic
local dragging, dragInput, dragStart, startPos
MainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)
UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)
RunService.RenderStepped:Connect(function()
    if dragging and dragInput then
        local delta = dragInput.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)
