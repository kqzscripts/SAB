-- Kqz Utility Hub (2025 COMPATIBLE)
-- Features: WalkSpeed, JumpPower, Checkpoint, FPS Boost, Rejoin
-- Optimized for: Steal a Brainrot / Bunni.lol

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer

-- ================= STATE =================
local State = {
    WalkSpeed = false,
    JumpPower = false,
    SavedPos = nil,
    Minimized = false
}

-- ================= GUI SETUP =================
-- Cleanup
local existing = CoreGui:FindFirstChild("KqzUtilityHub")
if existing then existing:Destroy() end

local gui = Instance.new("ScreenGui")
gui.Name = "KqzUtilityHub"
gui.Parent = CoreGui
gui.DisplayOrder = 999999
gui.ResetOnSpawn = false

pcall(function() gui.IgnoreGuiInset = true end)

local Main = Instance.new("Frame", gui)
Main.Name = "MainFrame"
Main.Size = UDim2.new(0, 330, 0, 320)
Main.Position = UDim2.fromScale(0.5, 0.5)
Main.AnchorPoint = Vector2.new(0.5, 0.5)
Main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Main.Active = true
Instance.new("UICorner", Main)

-- Dragging Logic
do
    local dragging, dragStart, startPos
    Main.InputBegan:Connect(function(i)
        if i.UserInputType == Enum.UserInputType.MouseButton1 or i.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = i.Position
            startPos = Main.Position
            i.Changed:Connect(function()
                if i.UserInputState == Enum.UserInputState.End then dragging = false end
            end)
        end
    end)
    UIS.InputChanged:Connect(function(i)
        if dragging and (i.UserInputType == Enum.UserInputType.MouseMovement or i.UserInputType == Enum.UserInputType.Touch) then
            local delta = i.Position - dragStart
            Main.Position = startPos + UDim2.fromOffset(delta.X, delta.Y)
        end
    end)
end

-- Layout Constants
local TITLE_HEIGHT = 35
local FOOTER_HEIGHT = 65

-- Title Bar
local TitleBar = Instance.new("Frame", Main)
TitleBar.Size = UDim2.new(1, 0, 0, TITLE_HEIGHT)
TitleBar.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
Instance.new("UICorner", TitleBar)

local TitleText = Instance.new("TextLabel", TitleBar)
TitleText.Size = UDim2.new(1, -70, 1, 0)
TitleText.Position = UDim2.new(0, 12, 0, 0)
TitleText.BackgroundTransparency = 1
TitleText.Text = "Kqz Utility Hub"
TitleText.Font = Enum.Font.GothamBold
TitleText.TextSize = 16
TitleText.TextColor3 = Color3.new(1, 1, 1)
TitleText.TextXAlignment = Enum.TextXAlignment.Left

-- Content Area (Scrolling)
local Content = Instance.new("ScrollingFrame", Main)
Content.Name = "ContentFrame"
Content.Position = UDim2.new(0, 10, 0, TITLE_HEIGHT + 10)
Content.Size = UDim2.new(1, -20, 1, -(TITLE_HEIGHT + FOOTER_HEIGHT + 20))
Content.BackgroundTransparency = 1
Content.CanvasSize = UDim2.new()
Content.AutomaticCanvasSize = Enum.AutomaticCanvasSize.Y
Content.ScrollBarThickness = 3
Content.ZIndex = 5

local Layout = Instance.new("UIListLayout", Content)
Layout.Padding = UDim.new(0, 8)

-- Footer (Player Info)
local Footer = Instance.new("Frame", Main)
Footer.Name = "FooterFrame"
Footer.Size = UDim2.new(1, -20, 0, FOOTER_HEIGHT)
Footer.Position = UDim2.new(0, 10, 1, -(FOOTER_HEIGHT + 5))
Footer.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
Footer.ZIndex = 2
Instance.new("UICorner", Footer)

local UserIDLabel = Instance.new("TextLabel", Footer)
UserIDLabel.Size = UDim2.new(1, 0, 1, 0)
UserIDLabel.BackgroundTransparency = 1
UserIDLabel.Text = "UserId: " .. player.UserId
UserIDLabel.Font = Enum.Font.Gotham
UserIDLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
UserIDLabel.TextSize = 14

-- ================= UI HELPERS =================
local function CreateButton(text, callback)
    local b = Instance.new("TextButton", Content)
    b.Size = UDim2.new(1, 0, 0, 38)
    b.BackgroundColor3 = Color3.fromRGB(55, 55, 55)
    b.Text = text
    b.Font = Enum.Font.GothamSemibold
    b.TextSize = 14
    b.TextColor3 = Color3.new(1, 1, 1)
    b.ZIndex = 6
    Instance.new("UICorner", b)
    b.MouseButton1Click:Connect(function() callback(b) end)
    return b
end

local function CreateToggle(text, callback)
    local on = false
    local b = CreateButton(text .. " : OFF", function(btn)
        on = not on
        btn.Text = text .. " : " .. (on and "ON" or "OFF")
        TweenService:Create(btn, TweenInfo.new(0.2), {
            BackgroundColor3 = on and Color3.fromRGB(80, 80, 80) or Color3.fromRGB(55, 55, 55)
        }):Play()
        callback(on)
    end)
    return b
end

-- ================= FEATURES =================
CreateToggle("WalkSpeed", function(v)
    State.WalkSpeed = v
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.WalkSpeed = v and 32 or 16 end
end)

CreateToggle("JumpPower", function(v)
    State.JumpPower = v
    local hum = player.Character and player.Character:FindFirstChild("Humanoid")
    if hum then hum.JumpPower = v and 80 or 50 end
end)

CreateButton("Save Checkpoint", function()
    local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    if hrp then 
        State.SavedPos = hrp.Position
        print("[KqzHub] Checkpoint Saved")
    end
end)

CreateButton("Teleport to Checkpoint", function()
    if State.SavedPos then
        local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if hrp then 
            hrp.CFrame = CFrame.new(State.SavedPos) 
            print("[KqzHub] Teleported to Checkpoint")
        end
    end
end)

CreateButton("FPS Boost", function()
    for _, v in ipairs(Lighting:GetChildren()) do
        if v:IsA("PostEffect") then v.Enabled = false end
    end
    print("[KqzHub] FPS Boost Applied")
end)

CreateButton("Rejoin", function()
    TeleportService:Teleport(game.PlaceId, player)
end)

-- ================= TOGGLE KEYBIND =================
UIS.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == Enum.KeyCode.RightShift then
        gui.Enabled = not gui.Enabled
    end
end)

print("[KqzHub] Successfully Initialized")
